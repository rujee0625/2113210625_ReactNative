"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6339],{41537:function(e,t,a){a.r(t),a.d(t,{NavBarActionButtons:function(){return W}});var s=a(57437),n=a(2265),r=a(87138),i=a(16463),l=a(39671),o=a(36921),c=a(62557),d=a(38702),u=a(79979),m=a(57620),h=a(17591),f=a(60858),p=a(93055),x=a(89713),g=a(6398),v=a(32614),y=a(40054),b=a(54153),j=a(68687),w=a(79219),N=a(55043),k=a(65041),S=a(17414),C=a(95801);function E(e){if(0===e.length)return[];let t=e.filter(_).map(e=>({feedItem:e,insertedAtMs:new Date(e.inserted_at).getTime()})).sort((e,t)=>t.insertedAtMs-e.insertedAtMs),a=new Map;for(let{feedItem:e,insertedAtMs:l}of t){var s,n,r,i;let t=e.actors[0],o=null!==(i=null===(s=e.data)||void 0===s?void 0:s.screenId)&&void 0!==i?i:null===(n=e.data)||void 0===n?void 0:n.flowId,c=(null===(r=e.data)||void 0===r?void 0:r.screenId)!==void 0?"screen":"flow",d="".concat(c,"-").concat(o),u=a.get(d);if(void 0===u){a.set(d,[{id:"".concat(d,"-").concat(e.inserted_at),type:c,entityId:o,items:[e],actors:[t],latestActor:t,latestInsertedAt:e.inserted_at,hasUnread:null===e.read_at}]);continue}let m=u.at(-1);if(void 0===m)throw Error("Invariant violation: group exists without a batch");let h=new Date(m.latestInsertedAt).getTime();l>h-36e5&&l<=h?(m.items.push(e),m.actors.some(e=>e.id===t.id)||m.actors.push(t),m.hasUnread=m.hasUnread||null===e.read_at):u.push({id:"".concat(d,"-").concat(e.inserted_at),type:c,entityId:o,items:[e],actors:[t],latestActor:t,latestInsertedAt:e.inserted_at,hasUnread:null===e.read_at})}return Array.from(a.values()).flat().sort((e,t)=>new Date(t.latestInsertedAt).getTime()-new Date(e.latestInsertedAt).getTime())}function _(e){var t,a;let s=e.actors.at(0);return void 0!==s&&"name"in s&&("string"==typeof(null===(t=e.data)||void 0===t?void 0:t.screenId)||"string"==typeof(null===(a=e.data)||void 0===a?void 0:a.flowId))}function A(e){return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,s.jsx)("title",{children:"bell icon"}),(0,s.jsx)("path",{d:"M12 5.33337C12 4.27251 11.5786 3.25509 10.8284 2.50495C10.0783 1.7548 9.06087 1.33337 8 1.33337C6.93913 1.33337 5.92172 1.7548 5.17157 2.50495C4.42143 3.25509 4 4.27251 4 5.33337C4 10 2 11.3334 2 11.3334H14C14 11.3334 12 10 12 5.33337Z",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M9.15335 14C9.03614 14.2021 8.86791 14.3698 8.6655 14.4864C8.46309 14.6029 8.2336 14.6643 8.00001 14.6643C7.76643 14.6643 7.53694 14.6029 7.33453 14.4864C7.13212 14.3698 6.96389 14.2021 6.84668 14",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]})}let I=(0,n.forwardRef)(function(e,t){let{showDot:a,...n}=e;return(0,s.jsxs)("button",{...n,className:"relative",title:"Notifications",ref:t,children:[(0,s.jsx)(A,{className:"pointer-events-none size-20"}),a?(0,s.jsx)("div",{className:"absolute -right-[2px] -top-[2px] size-[10px] rounded-full border-2 border-bg-primary bg-blue-200",role:"img","aria-label":"Unread badge"}):null]})});function M(){return(0,s.jsxs)("div",{className:"flex max-w-[298px] flex-col items-center justify-center gap-12",children:[(0,s.jsx)("h3",{className:"text-body-large-bold text-fg-primary",children:"No notifications yet"}),(0,s.jsx)("p",{className:"text-center text-body-small text-fg-secondary",children:"Youâ€™ll get notified whenever a teammate mentions you."})]})}var U=a(76991),L=a(64321),P=a(82804);function D(e){switch(e.node.type){case L.H.SchemaLatest.SCHEMA.nodes.doc:return(0,s.jsx)("div",{children:(0,L.L)(e.node,(t,a)=>(0,s.jsx)(D,{node:t,isUnread:e.isUnread},a))});case L.H.SchemaLatest.SCHEMA.nodes.paragraph:return(0,s.jsx)("p",{children:(0,L.L)(e.node,(t,a)=>(0,s.jsx)(D,{node:t,isUnread:e.isUnread},a))});case L.H.SchemaLatest.SCHEMA.nodes.br:return" ";case L.H.SchemaLatest.SCHEMA.nodes.text:return e.node.text;case L.H.SchemaLatest.SCHEMA.nodes.mentionAnchor:return"@";case L.H.SchemaLatest.SCHEMA.nodes.mention:var t;return(0,s.jsxs)("span",{className:(0,u.A)(e.isUnread?"text-body-medium-bold text-blue-200":"text-body-medium text-fg-secondary"),children:["@",null!==(t=e.node.attrs.userFullName)&&void 0!==t?t:(0,L.L)(e.node,(t,a)=>(0,s.jsx)(D,{node:t,isUnread:e.isUnread},a))]});default:return null}}function H(e){let t=(0,n.useMemo)(()=>P.yy.create({doc:L.H.commentJsonToDoc(e.commentJson),schema:L.H.SchemaLatest.SCHEMA}),[e.commentJson]);return(0,s.jsx)(D,{node:t.doc,isUnread:e.isUnread})}function z(e){let t=L.H.COMMENT_JSON_SCHEMA.safeParse(e.commentJson);return!1===t.success?null:(0,s.jsx)("div",{className:(0,u.A)("line-clamp-2 text-body-medium",e.isUnread?"text-fg-primary":"text-fg-secondary"),children:(0,s.jsx)(H,{commentJson:t.data,isUnread:e.isUnread})})}var O=a(29796),R=a(95682);function T(e){return(0,s.jsx)("span",{className:"ml-8 text-body-small text-fg-secondary",title:(0,O.Z)(e.date,"d MMM yyyy"),children:(0,R.X)(e.date.getTime())})}let V=(0,n.forwardRef)(function(e,t){var a,n,r;let{batch:i,knockFeed:l}=e,o=i.actors.at(0);if(void 0===o)return null;let c=i.items.at(0);if(void 0===c)return null;let d=i.items.some(e=>null===e.read_at);return(0,s.jsxs)("div",{ref:t,className:(0,u.A)("flex w-full items-start gap-8 rounded-12 p-12","cursor-pointer light:hover:bg-bg-secondary dark:hover:bg-bg-tertiary"),onClick:()=>{var e;l.markAsRead(i.items);let t=i.items.at(0);null!==t.tenant&&S.aX.track("Notification Feed Item Clicked",{workspace_id:t.tenant,feed_item:{type:"comment_mention",comment_id:null===(e=t.data)||void 0===e?void 0:e.commentId}}),null!==t.data&&("screenId"in t.data?window.open("".concat(window.location.origin,"/screens/").concat(t.data.screenId),"_blank"):"flowId"in t.data&&window.open("".concat(window.location.origin,"/flows/").concat(t.data.flowId),"_blank"))},children:[(0,s.jsx)(U.q,{size:"small",name:null!==(n=o.name)&&void 0!==n?n:"User",imageUrl:null!==(r=o.avatar)&&void 0!==r?r:void 0}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-[2px]",children:[(0,s.jsxs)("div",{className:"relative flex items-center gap-12 pr-16",children:[(0,s.jsxs)("h3",{className:(0,u.A)("text-pretty text-fg-primary",d?"text-body-medium-bold":"text-body-medium"),children:[(0,s.jsxs)("span",{className:"text-body-medium-bold",children:[i.actors.length>1?"".concat(o.name," and others"):o.name," "]}),"mentioned you",(0,s.jsx)(T,{date:new Date(c.inserted_at)})]}),d?(0,s.jsx)("div",{className:"absolute right-0 top-1/2 size-8 -translate-y-1/2 rounded-full bg-blue-200",role:"img","aria-label":"Unread badge"}):null]}),1===i.actors.length?(0,s.jsx)(z,{commentJson:null===(a=c.data)||void 0===a?void 0:a.commentJson,isUnread:d}):null]})]})}),B=C.h.get("NEXT_PUBLIC_KNOCK_FEED_CHANNEL_ID");function F(){var e;let t=(0,j.ys)(),a=(0,l.lz)(),r=(0,j.zn)(t,B,{tenant:null===(e=a.workspace)||void 0===e?void 0:e.id}),{items:i,metadata:o,networkStatus:c}=(0,j.Gu)(r),d=E(i);return(0,n.useEffect)(()=>{r.fetch()},[r]),(0,s.jsxs)(w.fC,{onOpenChange:async e=>{!1!==e&&a.workspace&&(S.aX.track("Notification Feed Opened",{workspace_id:a.workspace.id}),await r.markAllAsSeen())},children:[(0,s.jsx)(w.xz,{asChild:!0,children:(0,s.jsx)(I,{showDot:o.unseen_count>0})}),(0,s.jsx)(w.Uv,{children:(0,s.jsx)(w.VY,{collisionPadding:8,sideOffset:20,side:"bottom",align:"end",onCloseAutoFocus:e=>{e.preventDefault()},asChild:!0,children:(0,s.jsxs)("div",{className:(0,u.A)("w-[400px]","flex flex-col items-stretch gap-8 rounded-16 p-8 hidden:hidden","light:bg-bg-primary dark:bg-bg-secondary","select-none overflow-hidden shadow-dropdown","[&_button]:hover:ring-0","data-state-open:animate-in data-state-closed:animate-out","[--tw-in-duration:150ms] [--tw-out-duration:150ms]","[--tw-enter-opacity:0] [--tw-exit-opacity:0]"),children:[(0,s.jsx)("div",{className:"rounded-16 px-12 pt-8",children:(0,s.jsx)("h2",{className:"text-body-medium-bold text-fg-primary",children:"Notifications"})}),(0,s.jsx)("div",{className:"h-[400px]",children:c===b.Ie.loading?(0,s.jsx)("div",{className:"flex h-1/3 w-full items-center justify-center",children:(0,s.jsx)(k.i,{})}):(null==d?void 0:d.length)>0?(0,s.jsx)(N.x,{children:(0,s.jsx)("div",{className:"gap-2 -mr-[6px] flex h-full flex-col pr-12",children:(0,s.jsx)(N.w,{children:null==d?void 0:d.map(e=>(0,s.jsx)(w.ck,{asChild:!0,children:(0,s.jsx)(V,{batch:e,knockFeed:r})},e.id))})})}):(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)(M,{})})})]})})})]})}var q=a(3393);let J=C.h.get("NEXT_PUBLIC_KNOCK_FEED_CHANNEL_ID");function K(){var e;let t=(0,j.ys)(),a=(0,l.lz)(),r=(0,j.zn)(t,J,{tenant:null===(e=a.workspace)||void 0===e?void 0:e.id}),{items:i,metadata:o,networkStatus:c}=(0,j.Gu)(r),d=E(i);return(0,n.useEffect)(()=>{r.fetch()},[r]),(0,s.jsxs)(q.u_,{size:"large",children:[(0,s.jsx)(q.iq,{onClick:async()=>{a.workspace&&(S.aX.track("Notification Feed Opened",{workspace_id:a.workspace.id}),await r.markAllAsSeen())},children:(0,s.jsx)(I,{showDot:o.unseen_count>0})}),(0,s.jsxs)(q.hz,{title:"Notifications",children:[(0,s.jsx)(q.xB,{children:(0,s.jsx)("h2",{className:"truncate text-center text-body-large-bold",children:"Notifications"})}),(0,s.jsx)(q.fe,{children:c===b.Ie.loading?(0,s.jsx)("div",{className:"flex h-1/3 w-full items-center justify-center",children:(0,s.jsx)(k.i,{})}):(null==d?void 0:d.length)>0?(0,s.jsx)(N.x,{children:(0,s.jsx)("div",{className:"flex h-full flex-col px-16",children:(0,s.jsx)(N.w,{children:null==d?void 0:d.map(e=>(0,s.jsx)(V,{batch:e,knockFeed:r},e.id))})})}):(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)(M,{})})})]})]})}function G(){return 720>(0,c._C)()?(0,s.jsx)(K,{}):(0,s.jsx)(F,{})}function W(){var e,t,a,b,j,w;let N=(0,l.lz)(),k=(0,m.qU)({workspaceId:null===(e=N.workspace)||void 0===e?void 0:e.id}),S=(0,n.useMemo)(()=>{var e,t;if(N.isLoading||void 0===N.membershipPlan)return[];let a=[];return a.push("SAVED"),("none"===N.membershipPlan||(null===(e=N.subscriptionState)||void 0===e?void 0:e.trialState)!==void 0)&&a.push("UPGRADE_TO_PRO"),(null===(t=N.subscriptionState)||void 0===t?void 0:t.status)==="paused"&&!0===k.isModalReady&&a.push("RESUME_SUBSCRIPTION"),a},[N.isLoading,N.membershipPlan,null===(t=N.subscriptionState)||void 0===t?void 0:t.status,null===(a=N.subscriptionState)||void 0===a?void 0:a.trialState,k.isModalReady]),C=(0,f.t)(),E=(0,f.v)(),_=(0,p.dU)(),A=(0,c._C)(),I=(0,i.useRouter)(),{user:M}=(0,g.av)(),U={team:!0,enterprise:!0,personal:!1,none:!1}[null!==(j=N.membershipPlan)&&void 0!==j?j:"none"]&&({active:!0,will_cancel:!0,will_pause:!0,not_started:!1,paused:!1,canceled:!1,no_seat:!1})[null!==(w=null===(b=N.subscriptionState)||void 0===b?void 0:b.status)&&void 0!==w?w:"no_seat"];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row items-center gap-16 min-720:justify-end min-720:gap-24",children:[S.includes("SAVED")&&(0,s.jsx)("div",{className:"hidden min-1024:block",children:(0,s.jsx)(r.default,{href:(0,y.V)({platformType:(0,v.vJ)(C),contentType:E}),shallow:!0,className:(0,u.A)("text-body-medium-bold text-fg-primary","hover:text-opacity-80","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),scroll:!1,children:"Saved"})}),S.includes("UPGRADE_TO_PRO")&&(0,s.jsx)("div",{className:"hidden items-center justify-center min-1024:flex",children:(0,s.jsx)("button",{type:"button",onClick:()=>{A<720?I.push("/pricing"):_.showModal()},className:(0,u.A)("text-body-medium-bold text-blue-200","hover:text-opacity-80","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),"data-cre-user-type":"free_user",children:(0,s.jsxs)("span",{className:"flex items-center justify-center gap-x-4 whitespace-nowrap",children:["Get Pro",(0,s.jsx)(d.f,{className:"size-20"})]})})}),S.includes("RESUME_SUBSCRIPTION")&&(0,s.jsx)("div",{className:"hidden min-1024:block",children:(0,s.jsx)(o.z,{variant:"primary",size:"large",onClick:()=>k.openModal(),state:k.isModalOpen?"loading":"default",children:"Resume subscription"})}),!N.isLoading&&void 0===N.membershipPlan&&(0,s.jsxs)("div",{className:"hidden items-center justify-center gap-24 min-1024:flex",children:[(0,s.jsx)(r.default,{href:{pathname:"/pricing"},shallow:!0,className:(0,u.A)("whitespace-nowrap text-body-medium-bold text-fg-primary","hover:text-opacity-80","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),"data-cre-user-type":"visitor",children:"Pricing"}),(0,s.jsx)(r.default,{href:{pathname:"/login",query:{redirect_to:(0,x.a9)()}},shallow:!0,className:(0,u.A)("whitespace-nowrap text-body-medium-bold text-fg-primary","hover:text-opacity-80","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),children:"Log in"}),(0,s.jsx)(r.default,{href:{pathname:"/signup",query:{redirect_to:(0,x.a9)()}},passHref:!0,shallow:!0,legacyBehavior:!0,children:(0,s.jsx)(o.Q,{size:"large",children:"Create free account"})})]}),"string"==typeof(null==M?void 0:M.id)&&U&&(0,s.jsx)(G,{}),(0,s.jsx)(h.GlobalDropdownMenu,{})]}),(0,s.jsx)(m.fp,{isModalOpen:k.isModalOpen})]})}},84224:function(e,t,a){a.r(t),a.d(t,{NavBarNavigationTabs:function(){return d}});var s=a(57437),n=a(2265),r=a(87138),i=a(16463),l=a(79979),o=a(89713),c=a(32614);function d(){let e=(0,i.usePathname)(),t=(0,i.useParams)(),a=(0,n.useMemo)(()=>(null==e?void 0:e.startsWith("/browse"))===!0?"browse":(null==e?void 0:e.startsWith("/search"))===!0?"search":null,[e]),d=(0,n.useMemo)(()=>{let e;if(null===t)return null;switch("platform"in t&&(e=t.platform),a){case"browse":case"search":return(0,c.n$)(e)?e:null;default:return null}},[a,t]),u=(0,n.useMemo)(()=>{let e;if(null===t)return null;switch("contentType"in t&&(e=t.contentType),a){case"browse":case"search":return(0,c.Um)(e)?e:null;default:return null}},[a,t]);return(0,s.jsx)("div",{className:(0,l.A)("flex items-center","py-4 min-840:py-0","h-44 min-840:h-[unset]","gap-x-16 min-840:gap-x-24"),children:c.VT.map(e=>(0,s.jsx)(r.default,{href:function(e){let t=null!=a?a:"browse";return"/".concat(t,"/").concat(e,"/").concat("web"!==e&&"marketing-pages"===u?"screens":null!=u?u:"apps").concat((0,o.G3)(["filter","sort"]))}(e),className:(0,l.A)("text-body-medium-bold",d!==e&&"text-fg-tertiary","hover:text-fg-primary","transition-colors ease-out","focus-visible:ring-4 focus-visible:ring-blue-200/50"),prefetch:"browse"===a||void 0,...d===e?{"aria-current":"page"}:{},children:(0,c.w$)(e)},e))})}},14917:function(e,t,a){a.r(t),a.d(t,{NavBarSearchBar:function(){return K}});var s=a(57437),n=a(2265),r=a(62557),i=a(46647),l=a(79979),o=a(17414),c=a(13230),d=a(60858),u=a(36073),m=a(50213),h=a(38079),f=a(32614),p=a(16463),x=a(29340),g=a(95127),v=a(42408),y=a(18385),b=a(6086);function j(e){return(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,s.jsx)("title",{children:"check circle icon"}),(0,s.jsx)("path",{d:"M8.00016 14.6667C11.6821 14.6667 14.6668 11.6819 14.6668 8.00004C14.6668 4.31814 11.6821 1.33337 8.00016 1.33337C4.31826 1.33337 1.3335 4.31814 1.3335 8.00004C1.3335 11.6819 4.31826 14.6667 8.00016 14.6667Z",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"}),(0,s.jsx)("path",{d:"M10.6668 6L7.00016 9.66667L5.3335 8",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]})}function w(e){return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",stroke:"currentColor",fill:"none",...e,children:[(0,s.jsx)("title",{children:"visual search icon"}),(0,s.jsx)("path",{d:"M2.40015 5.1999V3.0999C2.40015 2.71331 2.71355 2.3999 3.10015 2.3999H5.20015M2.40015 10.7999V12.8999C2.40015 13.2865 2.71355 13.5999 3.10015 13.5999H5.20015M10.8001 2.3999H12.9001C13.2868 2.3999 13.6001 2.71331 13.6001 3.0999V5.1999M13.6001 10.7999V12.8999C13.6001 13.2865 13.2868 13.5999 12.9001 13.5999H10.8001M6.60015 10.0999H9.40015C9.78676 10.0999 10.1001 9.78651 10.1001 9.3999V6.5999C10.1001 6.21331 9.78676 5.8999 9.40015 5.8999H6.60015C6.21355 5.8999 5.90015 6.21331 5.90015 6.5999V9.3999C5.90015 9.78651 6.21355 10.0999 6.60015 10.0999Z",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]})}var N=a(6398);let k=["image/png","image/jpeg","image/webp"];a(74590);var S=a(58064),C=(0,S.$)("34e43e2970a0dd77c58a1cf7701eba54de24e91e"),E=(0,S.$)("75fea164a0896dd73f6671dcfa59c9576d3392ef"),_=(0,S.$)("89afb91d3326f19760ca6ab79e97a221a6987bfa"),A=a(39671),I=a(29522),M=a(45361),U=a(22263),L=a(15053),P=a(89713);function D(e){let t=(0,p.useRouter)(),a=void 0!==(0,A.lz)().membershipPlan,r=(0,n.useRef)(null);function i(){let e=new URLSearchParams,a=(0,P.a9)();"string"==typeof a&&e.append("redirect_to",a),t.push("/signup?".concat(e.toString()))}function o(t){if(t.preventDefault(),t.stopPropagation(),!a){i();return}e.onURLOptionSelect()}return(0,s.jsx)(I.GB,{dropzone:!0,type:"single_file",mimeTypes:k,onSelect:e.onFileSelect,onError:e=>{switch(e){case"invalid file type":return v.mv.toastError("Please upload a JPEG, PNG or WEBP image");case"multiple items not supported":return v.mv.toastError("Please upload one image at a time")}},disabled:!a,children:(0,s.jsxs)("div",{tabIndex:0,className:(0,l.A)("relative flex flex-col gap-y-16 rounded-[inherit]","data-dragged-over:after:opacity-100","after:pointer-events-none after:absolute after:inset-4","after:flex after:items-center after:justify-center after:rounded-16","after:border-2 after:border-dashed","after:light:border-neutral-gray-400 after:dark:border-neutral-gray-700","after:bg-bg-primary/40 after:opacity-0 after:backdrop-blur-xl","after:text-body-medium-bold after:text-fg-primary after:content-['Drop_here']","after:transition-all after:ease-out"),onClick:e=>{null!==r.current&&r.current.contains(e.target)||e.stopPropagation()},children:[(0,s.jsxs)("section",{className:(0,l.A)("flex flex-col gap-y-8 px-8 pt-8",e.previousVisualSearchImages.length>0?"pb-0":"pb-20"),children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-[2px] px-12 pt-8",children:[(0,s.jsx)("h3",{className:"text-body-medium-bold text-fg-primary",children:"Visual search"}),(0,s.jsx)("p",{className:"text-body-small text-fg-secondary",children:"Find similar designs using an image."})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-8",children:[(0,s.jsxs)("div",{className:"grid h-[104px] w-full grid-cols-2 items-stretch gap-x-8 px-12 py-8",children:[(0,s.jsx)(H,{ref:r,icon:M.H,onClick:()=>{a||i()},onKeyDown:e=>{if("Enter"===e.key||" "===e.key){if(!a){i();return}e.preventDefault()}},children:"Upload"}),(0,s.jsx)(H,{icon:U.H,onClick:o,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&o(e)},children:"URL"})]}),(0,s.jsx)("span",{className:"text-center text-body-small text-fg-secondary",children:"Drag & drop image."})]})]}),e.previousVisualSearchImages.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("hr",{className:"h-[1px] border-divider-primary"}),(0,s.jsxs)("section",{className:"flex flex-col gap-y-12 px-8 pb-20",children:[(0,s.jsx)("div",{className:"px-12 pt-8",children:(0,s.jsx)("p",{className:"text-body-small-bold text-fg-secondary",children:"Previous uploads"})}),(0,s.jsx)("div",{className:"flex gap-x-8 px-12",children:e.previousVisualSearchImages.map(t=>(0,s.jsx)("button",{onClick:()=>e.onPreviousVisualSearchImageSelect(t.id),className:(0,l.A)("relative overflow-hidden rounded-12 bg-bg-secondary","after:absolute after:inset-0 after:rounded-12 after:shadow-image-inset","focus-visible:ring-4 focus-visible:ring-blue-200/50"),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&e.stopPropagation()},children:(0,s.jsx)("img",{src:(0,L.S4)(t.imageUrl).src,alt:"previous upload",className:"size-64 object-cover"})},t.id))})]})]})]})})}let H=(0,n.forwardRef)(function(e,t){let{icon:a,...n}=e;return(0,s.jsxs)("button",{ref:t,className:(0,l.A)("flex flex-col items-center justify-center gap-y-8 rounded-16 bg-bg-tertiary","hover:bg-bg-quarternary active:bg-bg-quarternary","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),onClick:n.onClick,onKeyDown:n.onKeyDown,children:[(0,s.jsx)(a,{}),(0,s.jsx)("span",{className:"text-body-small-bold text-fg-primary",children:n.children})]})});var z=a(37515),O=a(58849),R=a(63082),T=a(82170);function V(e){let[t,a]=(0,n.useState)(""),[r,i]=(0,n.useState)(!1),o=(0,n.useRef)(null),c=(0,n.useCallback)(e=>{null!==e&&setTimeout(()=>e.focus(),200)},[]),d=(0,O.Y)(o,c);function u(){if(i(!0),!(0,z.PX)(t)){var a;i(!1),v.mv.toastError("Please use a valid URL"),null===(a=o.current)||void 0===a||a.classList.remove("animate-wiggle"),requestAnimationFrame(()=>{requestAnimationFrame(()=>{var e;null===(e=o.current)||void 0===e||e.classList.add("animate-wiggle")})});return}e.onSubmit(t)}return(0,s.jsxs)("div",{className:"flex cursor-text gap-x-8 px-12 py-8",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()},onKeyDown:t=>{"Escape"===t.key&&(t.preventDefault(),t.stopPropagation(),e.onCancel())},children:[(0,s.jsx)("input",{ref:d,size:1,type:"text",placeholder:"https://",value:t,onChange:e=>a(e.target.value),className:(0,l.A)("grow bg-transparent","text-body-small-bold text-fg-primary","placeholder:text-body-small placeholder:text-fg-tertiary"),onKeyDown:e=>{"Enter"===e.key&&u()}}),t.trim().length>0?(0,s.jsx)(T.z,{state:r?"loading":"default",icon:R.L,onClick:e=>{e.stopPropagation(),u()}}):(0,s.jsx)(T.z,{variant:"secondary",onClick:e.onCancel,children:"Cancel"})]})}let B={hidden:{opacity:0,transition:{duration:.15,type:"tween"}},visible:{opacity:1,transition:{duration:.15,delay:.2,type:"tween"}}};function F(e){switch(e.mode){case"default":return e.hasPreviousSearches?359:222;case"uploading":case"uploaded":return 222;case"url":return 68}}function q(e){let t=(0,p.useRouter)(),[a,r]=(0,n.useTransition)(),[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)("default"),[u,m]=(0,n.useState)(0),h=(0,N.Vn)();async function f(e){if(e.size>5e6){v.mv.toastError("Image is too large. Max 5 MB");return}d("uploading"),m(.3);try{let t=new FormData;t.append("image",e);let[a,s]=await Promise.all([_(t),h.mutateAsync({file:e,bucket:"user",subdirectory:"visual_search_images"})]);if("success"!==a.status)throw Error("Oh no, something went wrong. Try again?");m(.6);let n=await C({imageUrl:s.url,imageEmbedding:a.value});if("success"!==n.status)throw Error("Oh no, something went wrong. Try again?");S(n.value.id)}catch(e){v.mv.toastError(e instanceof Error?e.message:String(e)),d("default"),m(0)}}async function k(e){d("uploading"),m(.5);try{let t=await E({userImageUrl:e});if("success"!==t.status)switch(t.status){case"unauthenticated":throw Error("Please sign in to continue");case"unsupported content type":case"could not get file extension":throw Error("Please provide the URL of an image");case"image is too large":throw Error("Image is too large. Max 5 MB");case"upload failed":case"failed to generate embedding":case"query error":case"unexpected error":throw Error("Oh no, something went wrong. Try again?")}S(t.value.id)}catch(e){v.mv.toastError(e instanceof Error?e.message:String(e)),d("url"),m(0)}}function S(e){m(1),setTimeout(()=>{d("uploaded"),r(()=>{t.push("/search/ios/screens?filter=visualSearch.".concat(e)),t.refresh()})},150)}return(0,n.useEffect)(()=>{!1===a&&o(!1)},[a]),(0,s.jsxs)(y.J2,{open:i,onOpenChange:e=>{e&&(d("default"),m(0)),o(e)},children:[(0,s.jsx)(y.xo,{children:(0,s.jsx)("button",{className:(0,l.A)("absolute right-12 top-1/2 -translate-y-1/2","flex size-36 items-center justify-center rounded-12 text-fg-secondary","hover:text-fg-primary","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),children:(0,s.jsx)(w,{className:"size-20"})})}),(0,s.jsx)(y.yk,{children:(0,s.jsx)(x.E.div,{animate:{height:F({mode:c,hasPreviousSearches:e.previousVisualSearchImages.length>0}),transition:{duration:.15,type:"tween"}},className:"overflow-hidden",children:(0,s.jsx)(g.M,{initial:!1,children:(0,s.jsx)(x.E.div,{variants:B,initial:"hidden",animate:"visible",exit:"hidden",className:"default"!==c?"p-8":void 0,style:{height:F({mode:c,hasPreviousSearches:e.previousVisualSearchImages.length>0})},children:(()=>{switch(c){case"default":return(0,s.jsx)(D,{previousVisualSearchImages:e.previousVisualSearchImages,onPreviousVisualSearchImageSelect:e=>{r(()=>{t.push("/search/ios/screens?filter=visualSearch.".concat(e))})},onFileSelect:f,onURLOptionSelect:()=>d("url")});case"url":return(0,s.jsx)(V,{onSubmit:k,onCancel:()=>d("default")});case"uploading":return(0,s.jsxs)("div",{className:"flex size-full flex-col items-center justify-center gap-y-8",children:[(0,s.jsx)("span",{className:"text-body-small-bold text-fg-primary",children:"Uploading"}),(0,s.jsx)("div",{className:"w-[160px]",children:(0,s.jsx)(b.k,{max:1,value:u})})]});case"uploaded":return(0,s.jsxs)("div",{className:"flex size-full flex-col items-center justify-center gap-y-8",children:[(0,s.jsx)(j,{className:"size-32 text-fg-primary"}),(0,s.jsx)("span",{className:"text-body-small-bold text-fg-primary",children:"Uploaded"})]})}})()},c)})})})]})}let J=["Apps","Screens","UI Elements","Flows"];function K(e){let t=720>(0,r._C)(),a=(0,d.t)(),{isServerRendered:p}=(0,h.B)(),{setIsOpen:x}=(0,m.Ew)(),g=(0,u.a)();(0,c.aL)("mod+k",e=>{o.aX.track("Search Bar Opened",{source:"keyboard_shortcut"}),x(e=>!e),e.preventDefault()});let[v,y]=(0,n.useState)("Apps"),[b,j]=(0,n.useState)(null);return(0,n.useEffect)(()=>{if(!t||null===b)return;let e=setInterval(()=>{b.classList.remove("animate-in"),requestAnimationFrame(()=>{requestAnimationFrame(()=>{b.classList.add("animate-in"),y(e=>{var t;let a=J.indexOf(e);return null!==(t=J[(a+1)%J.length])&&void 0!==t?t:""})})})},2500);return()=>{clearInterval(e)}},[t,b]),(0,s.jsxs)("div",{className:"group relative",children:[(0,s.jsxs)("button",{className:(0,l.A)("relative min-w-0","flex h-40 w-full items-center gap-x-8 px-16 min-840:h-48 min-840:gap-x-12 min-840:px-20","justify-start","cursor-pointer rounded-24","bg-bg-tertiary text-fg-tertiary","group-hover:bg-bg-quarternary","focus-visible:ring-4 focus-visible:ring-blue-200/50","transition-colors ease-out"),onClick:()=>{o.aX.track("Search Bar Opened",{source:"click"}),x(!0)},children:[(0,s.jsx)(i.W,{className:"h-16 w-16 shrink-0 text-fg-primary min-840:h-20 min-840:w-20"}),t?(0,s.jsxs)("span",{className:"flex gap-4 truncate text-body-small-bold",children:["Search",(0,s.jsx)("span",{ref:j,className:"[--tw-enter-opacity:0] [--tw-enter-translate-y:-50%] [--tw-in-duration:500ms]",children:v})]}):p?null:(0,s.jsxs)("span",{className:"truncate text-body-medium-bold",children:["Search on ",(0,f.w$)(a),"..."]})]}),g&&!t&&(0,s.jsx)(q,{previousVisualSearchImages:e.previousVisualSearchImages}),(0,s.jsx)(m.E1,{})]})}}}]);